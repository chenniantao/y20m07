<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>234-ajax1</title>
</head>
<body>
    <button id="btn">Ajax获取数据</button>
</body>
<script>
    var btn = document.getElementById('btn')
    
    btn.onclick = function(){
        //XMLHttpRequest
        //1.购买电话
        var xhr = new XMLHttpRequest()
        //2.拨号
        xhr.open('POST','http://127.0.0.1:3000/',true)

        xhr.setRequestHeader('Content-Type','application/json');
        
        //3.说话(发送需求)
        xhr.send('{"name":"Tom","age":"18","city":"北京"}')
        //4.听(介绍响应)
        xhr.onreadystatechange = function(){
            /*
                0 没有初始化,还没有调用open方法
                1 启动,已调用open方法但是还没有调用send方法
                2 发送,已调用send方法但还没有返回数据
                3 接收,返回了部分数据
                4 完成,数据完全返回
             */
            if(xhr.readyState == 4){
                if(xhr.status == 200){
                    // console.log(xhr.responseText)
                    try{
                        var obj = JSON.parse(xhr.responseText)
                        console.log(obj) 
                    }catch(e){
                        console.log(e)
                    }
  
                }else{
                    console.log('failed request,status code = '+xhr.status)
                }
            }
        }


        console.log('do something....')
    }
    
</script>
</html>